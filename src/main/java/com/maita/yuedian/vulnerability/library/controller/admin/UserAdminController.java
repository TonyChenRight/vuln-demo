package com.maita.yuedian.vulnerability.library.controller.admin;

import com.baomidou.mybatisplus.core.metadata.IPage;
import com.maita.yuedian.vulnerability.library.context.UserContext;
import com.maita.yuedian.vulnerability.library.model.IdParam;
import com.maita.yuedian.vulnerability.library.model.R;
import com.maita.yuedian.vulnerability.library.model.user.UserEditParam;
import com.maita.yuedian.vulnerability.library.model.user.UserPage;
import com.maita.yuedian.vulnerability.library.model.user.UserPageParam;
import com.maita.yuedian.vulnerability.library.model.user.UserStatusParam;
import com.maita.yuedian.vulnerability.library.service.SysUserService;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.tags.Tag;
import jakarta.annotation.Resource;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;


@Validated
@Tag(name = "用户管理")
@RestController
@RequestMapping("/admin/user")
public class UserAdminController {
    @Resource
    private SysUserService sysUserService;

    @Operation(summary = "用户分页")
    @GetMapping("/page")
    public R<IPage<UserPage>> userPage(@Validated UserPageParam param) {
        return sysUserService.userPage(param);
    }

    @Operation(summary = "用户编辑")
    @PostMapping("/edit")
    public R<Long> userEdit(@Validated @RequestBody UserEditParam param) {
        return sysUserService.userEdit(param, UserContext.getUser());
    }

    @Operation(summary = "修改状态")
    @PostMapping("/status")
    public R<Long> userStatus(@Validated @RequestBody UserStatusParam param) {
        return sysUserService.userStatus(param, UserContext.getUser());
    }

    @Operation(summary = "重置密码")
    @PostMapping("/reset_password")
    public R<Long> userResetPassword(@Validated @RequestBody IdParam param) {
        return sysUserService.userResetPassword(param.getId(), UserContext.getUser());
    }

}