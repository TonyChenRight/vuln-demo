package com.maita.yuedian.vulnerability.library.utils;

import cn.hutool.core.util.StrUtil;
import jakarta.servlet.http.HttpServletRequest;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import java.util.Locale;


public class HttpContextUtils {

	public static HttpServletRequest getHttpServletRequest() {
		return ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest();
	}

	public static boolean isMultipartContent(HttpServletRequest request) {
		if (!StrUtil.equalsIgnoreCase("POST", request.getMethod())) {
			return false;
		}
		String contentType = request.getContentType();
		if (StrUtil.isBlank(contentType)) {
			return false;
		}
		return contentType.toLowerCase(Locale.ENGLISH).startsWith("multipart/");
	}
}
