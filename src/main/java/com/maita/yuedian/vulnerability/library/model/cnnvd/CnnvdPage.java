package com.maita.yuedian.vulnerability.library.model.cnnvd;

import cn.hutool.core.bean.BeanUtil;
import cn.hutool.core.date.DateUtil;
import com.maita.yuedian.vulnerability.library.domain.VuCnnvd;
import io.swagger.v3.oas.annotations.media.Schema;
import lombok.Data;

import java.util.Date;

@Data
public class CnnvdPage {

    @Schema(title = "ID", example = "1")
    private Long id;
    @Schema(title = "编码", example = "xx")
    private String code;
    @Schema(title = "名称", example = "xx")
    private String name;
    @Schema(title = "类型", example = "xx")
    private String type;
    @Schema(title = "描述", example = "xx")
    private String remark;
    @Schema(title = "级别 1-低危 2-中危 3-高危 4-超危", example = "1")
    private Integer level;
    @Schema(title = "修复方式", example = "xx")
    private String repairMethods;
    @Schema(title = "影响产品", example = "xx")
    private String affectProduct;
    @Schema(title = "CVE编号", example = "CVE-xxx")
    private String cveCode;
    @Schema(title = "发布时间", example = "2024-12-04")
    private String publishAt;
    @Schema(title = "更新时间", example = "2024-12-04")
    private String modifyAt;
    @Schema(title = "更新时间", example = "2024-12-04 10:00:00")
    private String createdAt;
    @Schema(title = "更新时间", example = "2024-12-04 10:00:00")
    private String updatedAt;
    @Schema(title = "创建人ID", example = "1")
    private Long creatorId;
    @Schema(title = "更新人ID", example = "1")
    private Long updaterId;
    @Schema(title = "创建人名称", example = "xx")
    private String creatorName;
    @Schema(title = "更新人名称", example = "xx")
    private String updaterName;

    public CnnvdPage(VuCnnvd vuCnnvd) {
        BeanUtil.copyProperties(vuCnnvd, this);
        Long publishTime = vuCnnvd.getPublishTime();
        if (publishTime != null && publishTime > 0) {
            this.publishAt = DateUtil.formatDate(new Date(publishTime));
        }
        Long modifyTime = vuCnnvd.getModifyTime();
        if (modifyTime != null && modifyTime > 0) {
            this.modifyAt = DateUtil.formatDate(new Date(modifyTime));
        }
        this.createdAt = DateUtil.formatDateTime(new Date(vuCnnvd.getCreatedTime()));
        this.updatedAt = DateUtil.formatDateTime(new Date(vuCnnvd.getUpdatedTime()));
    }
}
