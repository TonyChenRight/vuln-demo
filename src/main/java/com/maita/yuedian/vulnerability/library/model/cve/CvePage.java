package com.maita.yuedian.vulnerability.library.model.cve;

import cn.hutool.core.bean.BeanUtil;
import cn.hutool.core.date.DateUtil;
import com.maita.yuedian.vulnerability.library.domain.VuCve;
import io.swagger.v3.oas.annotations.media.Schema;
import lombok.Data;

import java.util.Date;
import java.util.List;

@Data
public class CvePage {

    @Schema(title = "ID", example = "1")
    private Long id;
    @Schema(title = "编码", example = "xx")
    private String code;
    @Schema(title = "名称", example = "xx")
    private String name;
    @Schema(title = "描述", example = "[\"xx\"]")
    private List<String> remarkList;
    @Schema(title = "级别 1-低危 2-中危 3-高危 4-超危", example = "1")
    private Integer level;
    @Schema(title = "评分", example = "5.0")
    private String score;
    @Schema(title = "修复方式", example = "[\"xx\"]")
    private List<String> repairMethodList;
    @Schema(title = "影响平台")
    private List<CveFileEntryAffect> affectRangeList;
    @Schema(title = "状态", example = "xx")
    private String state;
    @Schema(title = "发布时间", example = "2024-12-04 10:00:00")
    private String publishAt;
    @Schema(title = "更新时间", example = "2024-12-04 10:00:00")
    private String modifyAt;
    @Schema(title = "更新时间", example = "2024-12-04 10:00:00")
    private String createdAt;
    @Schema(title = "更新时间", example = "2024-12-04 10:00:00")
    private String updatedAt;
    @Schema(title = "创建人ID", example = "1")
    private Long creatorId;
    @Schema(title = "更新人ID", example = "1")
    private Long updaterId;
    @Schema(title = "创建人名称", example = "xx")
    private String creatorName;
    @Schema(title = "更新人名称", example = "xx")
    private String updaterName;

    public CvePage(VuCve vuCve) {
        BeanUtil.copyProperties(vuCve, this);
        Long publishTime = vuCve.getPublishTime();
        if (publishTime != null && publishTime > 0) {
            this.publishAt = DateUtil.formatDateTime(new Date(publishTime));
        }
        Long modifyTime = vuCve.getModifyTime();
        if (modifyTime != null && modifyTime > 0) {
            this.modifyAt = DateUtil.formatDateTime(new Date(modifyTime));
        }
        this.createdAt = DateUtil.formatDateTime(new Date(vuCve.getCreatedTime()));
        this.updatedAt = DateUtil.formatDateTime(new Date(vuCve.getUpdatedTime()));
        this.remarkList = vuCve.getRemarkList();
        this.repairMethodList = vuCve.getRepairMethodList();
        this.affectRangeList = vuCve.getAffectRangeList();
    }
}
